name: Build and Publish Docker Image
on:
    workflow_dispatch:
        inputs:
            version_bump:
                description: Version bump type
                required: true
                default: patch
                type: choice
                options: [major, minor, patch]

permissions:
    contents: write
    packages: write

jobs:
    publish:
        uses: DCC-BS/ci-workflows/.github/workflows/publish-docker.yml@v2
        secrets: inherit
        with:
            release_type: ${{ inputs.version_bump }} # major|minor|patch
            version_project_type: "python" # or "node"
            version_uv_version: "0.9.14"
            registry: ghcr.io
            image_name: ghcr.io/${{ github.repository }}
            context: .
            dockerfile: ./Dockerfile
            platforms: linux/amd64,linux/arm64
            push: true
